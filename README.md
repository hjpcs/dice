# 🎲 Dice Master (骰子大赛)

Dice Master 是一款基于 Flutter 开发的互动式骰子游戏应用。它通过分步投掷的机制增加游戏的紧张感和趣味性，并结合智能算法提供实时投掷建议，旨在为用户带来刺激的博弈体验。

## ✨ 功能介绍

### 1. 🎯 分步沉浸式投掷
告别传统的一次性投掷，采用 **Step-by-Step** 分步投掷模式：
- **第一步**：投掷第一个骰子，开启战局。
- **第二步**：投掷第二个骰子，局势渐明。
- **第三步**：投掷定胜负，揭晓最终结果。
*每次投掷伴随逼真的 3D 滚动动画，未投掷的骰子保持半透明悬念状态。*

### 2. 🤖 智能策略推荐
内置 `PredictionService` 智能预测引擎：
- 在投掷第 1 个和第 2 个骰子后，系统会自动分析剩余骰子的所有可能组合。
- 实时计算并展示 **Top 5 最优中奖方案**。
- 明确告知用户“接下来需要投出什么点数”才能获得最大奖励（如“豹子”、“顺子”等），辅助用户决策。

### 3. 🏆 丰富的中奖规则
支持多种经典骰子玩法判定：
- **豹子** (666, 111 等)：最高奖励。
- **顺子** (123, 456 等)。
- **对子** (两个点数相同)。
- **点数和** (大/小判定)。
*结果页提供详细的奖项说明和奖励金额展示。*

### 4. 📜 历史战绩记录
- 自动保存每一局的投掷结果和中奖情况。
- 提供独立的“历史记录”页面，支持下拉刷新，随时回顾过往的高光时刻。

### 5. 📱 现代化 UI 设计
- **底部导航栏**：清晰划分“中奖规则”、“开始投掷”、“历史记录”三大模块。
- **动态交互**：固定底部的投掷按钮、流畅的页面切换和结果弹窗动画。
- **自适应布局**：完美适配各种屏幕尺寸，确保内容完整展示不遮挡。

---

## 📂 项目架构

项目基于 Flutter 框架，采用清晰的分层架构，主要文件位于 `lib/` 目录下：

### 核心入口
- **`main.dart`**: 应用入口，配置主题和路由。包含 `MainPage`（底部导航框架）和 `DiceGamePage`（核心游戏页面）。

### 业务逻辑与服务
- **`dice_3d.dart`**: 负责 3D 骰子的渲染与动画逻辑，实现逼真的滚动效果。
- **`prediction_service.dart`**: 核心算法服务，负责计算剩余骰子的概率和推荐方案。
- **`reward_service.dart`**: 规则判定引擎，输入骰子点数，输出中奖类型和金额。
- **`history_service.dart`**: 数据持久化服务，基于 `shared_preferences` 管理历史记录的存储与读取。

### 页面与组件
- **`rule_page.dart`**: 展示详细的游戏规则说明。
- **`history_page.dart`**: 展示历史战绩列表，支持时间倒序排列。
- **`reward_dialog.dart`**: 游戏结束后的结算弹窗，展示最终结果和奖励。

---

## 🛠️ 依赖与构建

### 环境要求
- Flutter SDK: `^3.11.0`
- Dart SDK: Compatible with Flutter SDK

### 核心依赖 (`pubspec.yaml`)
| Package | Version | Description |
| :--- | :--- | :--- |
| `shared_preferences` | `^2.5.4` | 本地数据持久化，用于保存历史记录 |
| `intl` | `^0.20.2` | 时间日期格式化 |
| `screenshot` | `^3.0.0` | (预留) 屏幕截图功能 |
| `gal` | `^2.3.2` | (预留) 相册保存功能 |
| `permission_handler` | `^12.0.1` | 权限管理 |
| `path_provider` | `^2.1.5` | 文件路径获取 |

### 构建与运行

1.  **获取依赖**
    ```bash
    flutter pub get
    ```

2.  **运行应用**
    ```bash
    flutter run
    ```

3.  **运行测试**
    ```bash
    flutter test
    ```
    *项目包含完整的 Widget 测试用例，覆盖分步投掷和弹窗交互流程。*

---

## 📝 开发者说明

- **状态管理**：主要使用 `StatefulWidget` 结合 `setState` 进行局部状态管理，`IndexedStack` 保持页面状态。
- **动画系统**：使用 `AnimationController` 和 `CurvedAnimation` 实现自定义的骰子滚动曲线。
- **代码规范**：遵循官方 Dart/Flutter 编码规范，通过 `flutter_lints` 进行静态检查。

---

Enjoy the game! 🎲✨
